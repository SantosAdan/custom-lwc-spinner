<template>

    <lightning-card title={cardTitle} icon-name={cardIcon}>
        <template if:true={isLoading}>
            <lightning-spinner size="small" variant="brand" alternative-text="Loading..."></lightning-spinner>
        </template>

        <template if:true={noConfigFound}>
            <div class="slds-var-m-around_small slds-align_absolute-center">
                Não foi encontrado a configuração dos metadados customizados (DynamicPicklistLevel__mdt) necessários para funcionamento deste componente. Contate um administrador.
            </div>
        </template>

        <template if:true={readOnly}>
            <template for:each={fields} for:item="field">
                <lightning-input key={field.label} class="slds-var-m-around_small" label={field.label} value={field.value} disabled="true"></lightning-input>
            </template>
        </template>

        <template if:false={readOnly}>
            <template for:each={levels} for:item="level">
                <template if:true={level.show}>
                    <div key={level.order} class="slds-var-m-around_small">
                        <c-searchable-combobox 
                            label={level.fieldLabel} 
                            options={level.options} 
                            selected-value={level.selectedLevelName} 
                            onselect={handleChange}
                            data-name={level.order}>
                        </c-searchable-combobox>
                    </div>
                </template>
            </template>
        </template>

        <template if:false={noConfigFound}>
            <div slot="footer" class="slds-clearfix">
                <div class="slds-float_right">
                    <template if:false={readOnly}>
                        <lightning-button 
                            class="slds-var-p-right_x-small" 
                            variant="destructive" 
                            label="Cancelar" 
                            icon-name="utility:close" 
                            onclick={handleCancel}>
                        </lightning-button>
                        <lightning-button 
                            variant="brand" 
                            label="Salvar" 
                            icon-name="utility:save" 
                            onclick={handleSave}>
                        </lightning-button>
                    </template>
                    <template if:true={readOnly}>
                        <lightning-button 
                            variant="brand" 
                            label="Editar" 
                            icon-name="utility:edit" 
                            onclick={handleEdit}>
                        </lightning-button>
                    </template>
                </div>
            </div>
        </template>
    </lightning-card>

</template>